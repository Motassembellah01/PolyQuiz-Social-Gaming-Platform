<div class="manager-shell">
    <header class="top-bar">
        <div *ngIf="matchService.match.observers.length > 0" class="observer-indicator">
            <mat-icon>visibility</mat-icon>
            <span>{{ matchService.match.observers.length }}</span>
        </div>
        <button mat-raised-button class="background-red" (click)="finishMatch()">{{ 'NAV_BUTTONS.QUIT' | translate }}</button>
    </header>

    <app-qrl-evaluation id="evaluation-container" *ngIf="this.listenerSrv.evaluationSrv.isEvaluatingQrlQuestions"></app-qrl-evaluation>

    <section class="manager-layout">
        <mat-card class="players-panel">
            <h1>{{ 'TITLES.PLAYERS' | translate }}</h1>
            <app-players-list [isResultView]="false"></app-players-list>
        </mat-card>

        <mat-card class="control-panel">
            <app-question-display class="questions" [question]="question"></app-question-display>

            <div class="timer-and-actions" *ngIf="!this.listenerSrv.histogramSrv.isShowingQuestionResults">
                <div class="timer-card" [class.panic]="this.isPanicMode">
                    <div class="timer-value">{{ this.matchService.timeService.timer }}</div>
                    <mat-progress-spinner mode="determinate" [value]="(this.matchService.timeService.timer * 100) / this.maxTime" class="spinner">
                    </mat-progress-spinner>
                    <audio *ngIf="this.isPanicMode" controls autoplay (ended)="restartAudio()" #audioZone>
                        <source src="assets/panic_music.mp3" type="audio/mp3" />
                    </audio>
                </div>

                <div class="action-row">
                    <button
                        mat-raised-button
                        class="background-beige"
                        (click)="startPanicModeTimer()"
                        [disabled]="!isPanicModeSettable() || this.isPanicMode || isPaused"
                    >
                        {{ 'BUTTONS.PANIC_MODE' | translate }}
                    </button>
                    <button mat-raised-button class="background-green" (click)="timerPauseHandler()">
                        <i class="material-icons pointer" *ngIf="!isPaused">pause</i>
                        <i class="material-icons pointer" *ngIf="isPaused">play_arrow</i>
                    </button>
                </div>
            </div>

            <button mat-raised-button class="next-button background-beige" *ngIf="this.canMoveToNextQuestion() && !isObserver()" (click)="onNextQuestion()">
                {{ getTranslationNextQuestion() | translate }}
            </button>

            <button mat-raised-button class="next-button background-beige" *ngIf="this.canMoveToNextQuestion() && isObserver()">
                {{ getTranslationNextQuestion() | translate }}
            </button>
        </mat-card>
    </section>
</div>

<mat-card id="observer-controls" *ngIf="isObserver()">
    <h2>{{ 'TITLES.PLAYERS_TO_OBSERVE' | translate }}</h2>
    <mat-form-field appearance="outline">
        <mat-label>{{ 'TITLES.PLAYERS' | translate }}</mat-label>
        <mat-select [(value)]="selectedPlayer" (selectionChange)="onPlayerSelect($event.value)">
            <mat-option *ngFor="let player of matchService.match.players" [value]="player.name">
                {{ player.name }}
            </mat-option>
            <mat-option [value]="matchService.match.managerName">{{ 'Manager' | translate }}</mat-option>
        </mat-select>
    </mat-form-field>
</mat-card>
