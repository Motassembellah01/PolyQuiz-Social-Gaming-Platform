<div class="result-shell">
    <header class="top-bar">
        <p class="timer" *ngIf="matchSrv.match.testing">
            {{ transitionText }} {{ 'GENERAL.IN' | translate }} {{ this.timer }} {{ 'GENERAL.SECONDS' | translate }}
        </p>
        <div class="top-right-actions">
            <div *ngIf="matchSrv.match.observers.length > 0" class="observer-indicator">
                <mat-icon>visibility</mat-icon>
                <span>{{ matchSrv.match.observers.length }}</span>
            </div>
            <button mat-raised-button class="background-red" (click)="quitMatch()">{{ 'BUTTONS.ABANDON' | translate }}</button>
        </div>
    </header>

    <mat-card class="summary-card">
        <h1>{{ 'TITLES.QUESTION_RESULT' | translate }}</h1>

        <p *ngIf="!matchSrv.isObserver()"><strong>{{ accountService.account.pseudonym }}</strong>, {{ this.matchSrv.feedBackMessages[0] }}</p>
        <p *ngIf="matchSrv.isObserver()"><strong>{{ matchSrv.getObservedName() }}</strong>, {{ this.matchSrv.feedBackMessages[0] }}</p>
        <p>{{ this.matchSrv.feedBackMessages[1] }}</p>

        <mat-card class="score-chip" *ngIf="!matchSrv.match.isTeamMatch && !matchSrv.isObserver()">
            <mat-card-content>{{ 'TITLES.SCORE' | translate }}{{ matchSrv.player.score }} points</mat-card-content>
        </mat-card>

        <mat-card class="score-chip" *ngIf="!matchSrv.match.isTeamMatch && matchSrv.isObserver()">
            <mat-card-content>{{ 'TITLES.SCORE' | translate }}{{ matchSrv.match.getScoreOfPlayerByName(matchSrv.getObservedName()) }} points</mat-card-content>
        </mat-card>

        <div class="team-details" *ngIf="matchSrv.match.isTeamMatch && !matchSrv.isObserver()">
            <p>Ton score: {{ matchSrv.player.score }}</p>
            <p *ngIf="matchSrv.getTeammate(accountService.account.pseudonym)!.isActive">
                Score de <strong>{{ matchSrv.getTeammate(accountService.account.pseudonym)!.name }}</strong> :
                {{ matchSrv.getTeammate(accountService.account.pseudonym)!.score }}
            </p>
            <p *ngIf="!matchSrv.getTeammate(accountService.account.pseudonym)!.isActive">
                <strong>{{ matchSrv.getTeammate(accountService.account.pseudonym)!.name }}</strong> a quitté la partie avec un score de
                {{ matchSrv.getTeammate(accountService.account.pseudonym)!.score }}
            </p>
            <mat-card class="score-chip">
                <mat-card-content>
                    Score de l’équipe :
                    {{ matchSrv.calculateTeamScore(matchSrv.getTeamByPlayerName(accountService.account.pseudonym)) }} points
                </mat-card-content>
            </mat-card>
        </div>

        <div class="team-details" *ngIf="matchSrv.match.isTeamMatch && matchSrv.isObserver()">
            <p>Ton score: {{ matchSrv.match.getScoreOfPlayerByName(matchSrv.getObservedName()) }}</p>
            <p *ngIf="matchSrv.getTeammate(matchSrv.getObservedName())!.isActive">
                Score de <strong>{{ matchSrv.getTeammate(matchSrv.getObservedName())!.name }}</strong> :
                {{ matchSrv.getTeammate(matchSrv.getObservedName())!.score }}
            </p>
            <p *ngIf="!matchSrv.getTeammate(matchSrv.getObservedName())!.isActive">
                <strong>{{ matchSrv.getTeammate(matchSrv.getObservedName())!.name }}</strong> a quitté la partie avec un score de
                {{ matchSrv.getTeammate(matchSrv.getObservedName())!.score }}
            </p>
            <mat-card class="score-chip">
                <mat-card-content>
                    Score de l’équipe :
                    {{ matchSrv.calculateTeamScore(matchSrv.getTeamByPlayerName(matchSrv.getObservedName())) }} points
                </mat-card-content>
            </mat-card>
        </div>
    </mat-card>

    <div class="answer-panel">
        <app-question-answer></app-question-answer>
    </div>
</div>

<mat-card id="observer-controls" *ngIf="matchSrv.isObserver()">
    <h2>{{ 'TITLES.PLAYERS_TO_OBSERVE' | translate }}</h2>
    <mat-form-field appearance="outline">
        <mat-label>{{ 'TITLES.PLAYERS' | translate }}</mat-label>
        <mat-select [(value)]="selectedPlayer" (selectionChange)="onPlayerSelect($event.value)">
            <mat-option *ngFor="let player of matchSrv.match.players" [value]="player.name">
                {{ player.name }}
            </mat-option>
            <mat-option [value]="matchSrv.match.managerName">{{ 'Manager' | translate }}</mat-option>
        </mat-select>
    </mat-form-field>
</mat-card>
