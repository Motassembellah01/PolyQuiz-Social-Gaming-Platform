<div class="chat-dock">
    <button
        class="toggle-button material-icons pointer color-blue"
        type="button"
        [@chatAnimation]="!isChatVisible ? 'open' : 'closed'"
        (click)="toggleChatVisibility()"
        aria-label="Open chat"
    >
        chevron_left
    </button>

    <section class="chat-panel" [@chatAnimation]="isChatVisible ? 'open' : 'closed'" (@chatAnimation.done)="onAnimationDone()">
        <header class="panel-header">
            <div class="header-text">
                <p class="eyebrow">Live Match</p>
                <h2 class="title-chat color-blue">Clavardage</h2>
            </div>
            <button class="material-icons pointer color-blue icon-button" type="button" (click)="toggleChatVisibility()" aria-label="Close chat">
                chevron_right
            </button>
        </header>

        <div class="chat-zone" #chatZone>
            <app-chat-message *ngFor="let message of this.matchService.chatService.messagesList" [message]="message"></app-chat-message>
        </div>

        <footer class="composer">
            <mat-form-field appearance="outline" subscriptSizing="dynamic">
                <textarea
                    cdkTextareaAutosize
                    cdkAutosizeMinRows="1"
                    cdkAutosizeMaxRows="4"
                    class="italic input-field"
                    id="chat-field"
                    name="inputMessage"
                    (focus)="changeTypingState()"
                    (blur)="changeTypingState()"
                    [(ngModel)]="this.message"
                    (keydown)="onEntryKey($event)"
                    [disabled]="matchService.player.chatBlocked"
                    matInput
                    #input
                    maxlength="200"
                    [placeholder]="!matchService.player.chatBlocked ? 'Type your message...' : 'Clavardage désactivé'"
                ></textarea>

                <button
                    mat-icon-button
                    matSuffix
                    type="button"
                    class="send-button"
                    [class.disabled]="this.matchService.player.chatBlocked"
                    [disabled]="this.matchService.player.chatBlocked"
                    (click)="!this.matchService.player.chatBlocked && sendMsg(this.message)"
                    aria-label="Send message"
                >
                    <mat-icon [ngClass]="{ pink: input.value.length !== 0 && !this.matchService.player.chatBlocked }">send</mat-icon>
                </button>
                <mat-hint align="end">{{ input.value.length }}/200 </mat-hint>
            </mat-form-field>
        </footer>
    </section>
</div>
